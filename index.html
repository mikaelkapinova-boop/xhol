<!DOCTYPE html>
<html lang="fr">
<head
  >
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Msplomberie - Jeu de Cartes</title>

  <style
    >
    /* == Styles généraux == */
    body
    {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Roboto', Arial, sans-serif;
      background-color: #1b1120;
      color: white;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      user-select: none;
    }

    a
    {
      color: inherit;
      text-decoration: none;
      cursor: pointer;
    }

    header
    {
      background-color: #2a1f34;
      padding: 15px 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 0 12px #5d3e84;
      color: #e0dfff;
      user-select: none;
    }

    .user-info
    {
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .user-info img
    {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      border: 2px solid #ffd932;
      object-fit: cover;
    }

    .user-info .username
    {
      font-weight: 700;
      font-size: 1.25rem;
      user-select: text;
    }

    .user-stats
    {
      display: flex;
      gap: 12px;
      font-size: 0.9rem;
      color: #bfc5ff;
      align-items: center;
      user-select: text;
    }

    nav a
    {
      margin-left: 20px;
      font-weight: 600;
      padding: 6px 14px;
      border-radius: 6px;
      background-color: #3b2f5a;
      color: #bfc5ff;
      text-decoration: none;
      transition: background-color 0.3s ease;
      user-select: none;
    }

    nav a:hover,
    nav a:focus
    {
      background-color: #ffd932;
      color: #2c2100;
      outline: none;
    }

    #auth-section
    {
      min-height: 100vh;
      background-color: #171025;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 50px 30px;
      gap: 28px;
      user-select: none;
    }

    .auth-box
    {
      background-color: #342f53;
      border-radius: 18px;
      box-shadow: 0 0 40px #6e58bfaa;
      padding: 36px;
      width: 360px;
      max-width: 90vw;
      color: #dedfff;
    }

    .auth-box h2
    {
      color: #ffd932;
      font-weight: 700;
      font-size: 2rem;
      text-align: center;
      margin-bottom: 28px;
      user-select: none;
    }

    label
    {
      display: block;
      margin-bottom: 6px;
      color: #bac0ff;
      font-weight: 600;
      user-select: none;
    }

    input[type="email"],
    input[type="password"]
    {
      width: 100%;
      padding: 12px 14px;
      font-size: 1rem;
      border-radius: 6px;
      border: none;
      background-color: #3a2f7f;
      color: #dcdfff;
      outline-offset: 2px;
      outline-color: #9a86ef;
      margin-bottom: 18px;
      font-family: inherit;
      user-select: text;
    }

    input[type="email"]:focus,
    input[type="password"]:focus
    {
      background-color: #483d99;
      outline-color: #ffd932;
    }

    input[type="submit"],
    button.switch-btn
    {
      width: 100%;
      padding: 14px 0;
      font-size: 1.125rem;
      font-weight: 700;
      border-radius: 12px;
      border: none;
      background-color: #ffd932;
      color: #2c2000;
      cursor: pointer;
      transition: background-color 0.3s ease;
      user-select: none;
    }

    input[type="submit"]:hover,
    button.switch-btn:hover
    {
      background-color: #fff348;
    }

    button.switch-btn
    {
      background: none;
      color: #[94a1ff];
      font-weight: 600;
      text-decoration: underline;
      margin-top: 14px;
      padding: 0;
      user-select: text;
      border-radius: 0;
    }

    .error-message
    {
      color: #f5625c;
      font-weight: 700;
      min-height: 20px;
      margin-bottom: 18px;
      user-select: none;
    }

    .success-message
    {
      color: #6aff85;
      font-weight: 700;
      margin-top: 4px;
      min-height: 20px;
      user-select: none;
    }

    .hidden
    {
      display: none !important;
    }

    /* Lobby Styles */
    #lobby
    {
      display: none;
      flex-grow: 1;
      flex-direction: column;
      align-items: center;
      background: linear-gradient(135deg, #240b33 0%, #12081b 100%);
      min-height: 90vh;
      padding: 40px 30px;
      user-select: none;
    }

    #lobby.active
    {
      display: flex;
    }

    #lobby header
    {
      width: 100%;
      max-width: 960px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 40px;
      user-select: none;
    }

    #lobby .user-info
    {
      display: flex;
      gap: 14px;
      align-items: center;
      color: #b6b7ee;
      user-select: none;
    }

    #lobby .user-info img
    {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      border: 2px solid #ffd932;
      object-fit: cover;
      user-select: none;
    }

    #lobby .username
    {
      font-weight: 700;
      font-size: 1.35rem;
      user-select: text;
    }

    #lobby .user-stats
    {
      font-size: 1rem;
      color: #c2bfff;
    }

    #lobby nav a
    {
      font-weight: 600;
      color: #b6b7ee;
      background-color: #3a2f5a;
      padding: 10px 18px;
      border-radius: 10px;
      text-decoration: none;
      margin-left: 18px;
      transition: background-color 0.3s ease;
      user-select: none;
    }

    #lobby nav a:hover,
    #lobby nav a:focus
    {
      background-color: #ffd932;
      color: #2c2100;
      outline: none;
    }

    #lobby .modes
    {
      display: flex;
      gap: 48px;
      flex-wrap: wrap;
      justify-content: center;
      max-width: 960px;
      width: 100%;
      user-select: none;
    }

    .mode-card
    {
      width: 280px;
      background-color: #412e7a;
      border-radius: 22px;
      padding: 36px 22px;
      box-shadow: 0 0 48px #7052bcaa;
      color: #b5b3ee;
      cursor: pointer;
      text-align: center;
      transition: box-shadow 0.3s ease, transform 0.3s ease;
      user-select: none;
    }

    .mode-card:hover,
    .mode-card:focus
    {
      box-shadow: 0 0 72px #f3d12399;
      transform: scale(1.05);
      color: #ffd932;
      outline: none;
    }

    .mode-card img
    {
      margin-bottom: 26px;
      width: 120px;
      user-select: none;
      pointer-events: none;
    }

    .mode-card .title
    {
      font-weight: 700;
      font-size: 1.80rem;
      margin-bottom: 14px;
      letter-spacing: 0.05em;
      user-select: none;
    }

    .mode-card .desc
    {
      font-size: 1.05rem;
      user-select: none;
      color: #b5b2eeaa;
    }

    /* Game Styles */
    #game
    {
      display: none;
      flex-grow: 1;
      flex-direction: column;
      align-items: center;
      background-color: #220c46;
      min-height: 90vh;
      padding: 40px 30px;
      user-select: none;
    }

    #game.active
    {
      display: flex;
    }

    #game header
    {
      width: 100%;
      max-width: 960px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 36px;
      user-select: none;
    }

    #game .user-info
    {
      display: flex;
      align-items: center;
      gap: 14px;
      color: #b9b8f5;
      user-select: none;
    }

    #game .user-info img
    {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      border: 3px solid #ffd932;
      object-fit: cover;
      user-select: none;
    }

    #game .username
    {
      user-select: text;
      font-weight: 700;
      font-size: 1.5rem;
    }

    #game nav a
    {
      padding: 10px 20px;
      background-color: #3a2f60;
      color: #b9b7f1;
      border-radius: 12px;
      font-weight: 600;
      cursor: pointer;
      margin-left: 18px;
      text-decoration: none;
      transition: background-color 0.3s ease;
      user-select: none;
    }

    #game nav a:hover,
    #game nav a:focus
    {
      background-color: #ffd932;
      color: #2c2100;
      outline: none;
    }

    #game .table-layout
    {
      width: 100%;
      max-width: 960px;
      background-color: #412e89;
      border-radius: 28px;
      padding: 38px 28px 100px;
      box-shadow: 0 0 54px #7a5ab6cc;
      display: flex;
      flex-direction: column;
      align-items: center;
      user-select: none;
    }

    #game .drop-zones
    {
      display: flex;
      gap: 36px;
      width: 100%;
      margin-bottom: 42px;
      user-select: none;
    }

    .drop-zone
    {
      flex-basis: 48.5%;
      background-color: #512d7a;
      border-radius: 20px;
      border: 2px dashed #a088df;
      height: 150px;
      box-shadow: inset 0 0 30px #9f8accdd;
      padding: 12px 15px;
      overflow-x: auto;
      display: flex;
      gap: 18px;
      align-items: center;
      user-select: none;
      cursor: default;
    }

    .drop-zone.drag-over
    {
      background-color: #bdaafaff;
      border-color: #c3adff;
    }

    #game .player-hand
    {
      width: 100%;
      max-width: 960px;
      height: 120px;
      background-color: #493aa4;
      border-radius: 26px;
      box-shadow: 0 0 74px #9276fcdc;
      padding: 20px;
      overflow-x: auto;
      display: flex;
      gap: 20px;
      user-select: none;
    }

    .card
    {
      width: 95px;
      height: 130px;
      background-color: #1f1961;
      border-radius: 22px;
      border: 3px solid transparent;
      box-shadow: 0 0 14px rgba(0,0,0,0.85);
      color: #ebe9ff;
      font-weight: 700;
      cursor: grab;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 12px 15px;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
      user-select: none;
      user-drag: none;
    }

    .card.red
    {
      color: #f35858;
    }

    .card.dragging
    {
      cursor: grabbing;
      opacity: 0.45;
      border-color: #febd49;
      box-shadow: 0 0 68px #febd49;
      user-select: none;
    }

    #xhol-btn
    {
      margin-top: 52px;
      padding: 20px 68px;
      font-size: 1.88rem;
      font-weight: 700;
      color: #312240;
      background-color: #fed336;
      border: none;
      border-radius: 32px;
      box-shadow: 0 0 90px #ffef68bb;
      user-select: none;
      cursor: not-allowed;
      opacity: 0.38;
      transition: opacity 0.3s ease;
    }

    #xhol-btn.enabled
    {
      opacity: 1;
      cursor: pointer;
      box-shadow: 0 0 130px #fed336;
    }

    footer
    {
      background-color: #341f6e;
      color: #b1aff9;
      font-weight: 600;
      font-size: 1rem;
      padding: 28px 20px;
      text-align: center;
      user-select: none;
    }
  </style>
</head>
<body>
  <section id="auth-section">
    <div class="auth-box" id="login-card">
      <h2>
        Connexion
      </h2>
      <form id="login-form" autocomplete="off" novalidate>
        <label for="login-email">
          E-mail
        </label>
        <input type="email" id="login-email" autocomplete="username" required />
        <label for="login-password">
          Mot de passe
        </label>
        <input type="password" id="login-password" autocomplete="current-password" minlength="6" required />
        <input type="submit" value="Se connecter" />
        <p class="error-message" id="login-error" aria-live="assertive"></p>
      </form>
      <button class="switch-btn" id="show-register-btn">
        Créer un compte
      </button>
    </div>
    <div class="auth-box hidden" id="register-card">
      <h2>
        Créer un compte
      </h2>
      <form id="register-form" autocomplete="off" novalidate>
        <label for="register-email">
          E-mail
        </label>
        <input type="email" id="register-email" autocomplete="username" required />
        <label for="register-password">
          Mot de passe
        </label>
        <input type="password" id="register-password" autocomplete="new-password" minlength="6" required />
        <input type="submit" value="S’inscrire" />
        <p class="error-message" id="register-error" aria-live="assertive"></p>
      </form>
      <button class="switch-btn" id="show-login-btn">
        Déjà un compte
      </button>
    </div>
  </section>

  <main id="lobby" class="hidden" aria-label="Lobby">
    <header>
      <div class="user-info" aria-label="Profil joueur">
        <img id="user-avatar" />
        <span class="username" id="user-pseudo"></span>
        <div class="user-stats" id="user-stats"></div>
      </div>
      <nav>
        <a href="#" id="logout-btn">Déconnexion</a>
      </nav>
    </header>

    <section class="modes" aria-label="Choix du Mode" role="list">
      <article class="mode-card" id="mode-casual" tabindex="0" role="button" aria-pressed="false">
        <img src="https://cdn-icons-png.flaticon.com/512/616/616554.png" alt="Icone Casual" />
        <h3 class="title">Casual</h3>
        <p class="desc">Jouer pour le plaisir</p>
      </article>
      <article class="mode-card" id="mode-tournament" tabindex="0" role="button" aria-pressed="false">
        <img src="https://cdn-icons-png.flaticon.com/512/616/616601.png" alt="Icone Tournament" />
        <h3 class="title">Tournament</h3>
        <p class="desc">Défiez les meilleurs</p>
      </article>
    </section>
  </main>

  <main id="game" class="hidden" aria-label="Jeu">
    <header>
      <div class="user-info" aria-label="Profil joueur">
        <img id="game-avatar" />
        <span class="username" id="game-pseudo"></span>
        <div class="user-stats" id="game-stats"></div>
      </div>
      <nav>
        <a href="#" id="end-game">Quitter la Partie</a>
        <a href="#" id="logout-game">Déconnexion</a>
      </nav>
    </header>

    <section class="game-area">
      <section class="table-layout">
        <div id="drop-zone-1" class="drop-zone" aria-label="Zone 1"></div>
        <div id="drop-zone-2" class="drop-zone" aria-label="Zone 2"></div>
      </section>

      <section id="player-hand" class="player-hand" aria-label="Main du Joueur"></section>

      <button id="xhol-btn" disabled>Xhol</button>
    </section>
  </main>

  <footer>
    © 2025 - Msplomberie - Tous droits réservés
  </footer>

  <script
    >
    (() =>
    {
      const STORAGE_KEY = 'mspl_users';

      // DOM refs
      const authSection = document.getElementById('auth-section');
      const loginCard = document.getElementById('login-card');
      const registerCard = document.getElementById('register-card');

      const loginForm = document.getElementById('login-form');
      const registerForm = document.getElementById('register-form');

      const toRegisterBtn = document.getElementById('show-register-btn');
      const toLoginBtn = document.getElementById('show-login-btn');

      const lobby = document.getElementById('lobby');
      const logoutBtn = document.getElementById('logout-btn');

      const modeCasual = document.getElementById('mode-casual');
      const modeTournament = document.getElementById('mode-tournament');

      const gameScreen = document.getElementById('game');
      const logoutGameBtn = document.getElementById('logout-game');
      const endGameBtn = document.getElementById('end-game');

      const avatarLobby = document.getElementById('user-avatar');
      const pseudoLobby = document.getElementById('user-pseudo');
      const statsLobby = document.getElementById('user-stats');

      const avatarGame = document.getElementById('game-avatar');
      const pseudoGame = document.getElementById('game-pseudo');
      const statsGame = document.getElementById('game-stats');

      const dropZones = [
        document.getElementById('drop-zone-1'),
        document.getElementById('drop-zone-2'),
      ];

      const playerHand = document.getElementById('player-hand');
      const xholBtn = document.getElementById('xhol-btn');

      // State
      let users = {};
      let currentUser = null;
      let draggedCard = null;
      let deck = [];

      // STORAGE helpers
      const loadUsers = () =>
      {
        try
        {
          return JSON.parse(localStorage.getItem(STORAGE_KEY)) || {};
        }
        catch
        {
          return {};
        }
      };

      const saveUsers = data =>
      {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
      };

      const hashPassword = str =>
      {
        return btoa(unescape(encodeURIComponent(str)));
      };

      // UI switches
      const showLogin = () =>
      {
        loginCard.classList.remove('hidden');
        registerCard.classList.add('hidden');
        clearMessages();
      };

      const showRegister = () =>
      {
        registerCard.classList.remove('hidden');
        loginCard.classList.add('hidden');
        clearMessages();
      };

      const clearMessages = () =>
      {
        document.getElementById('login-error').textContent = '';
        document.getElementById('register-error').textContent = '';
      };

      // Load user profile data
      const loadProfile = () =>
      {
        if (!currentUser)
        {
          return;
        }
        const profile = users[currentUser]?.profile;

        if (!profile)
        {
          return;
        }

        const avatarIndex = (profile.pseudo.charCodeAt(0) + profile.niveau) % 99;
        const avatarUrl = `https://randomuser.me/api/portraits/men/${avatarIndex}.jpg`;

        avatarLobby.src = avatarUrl;
        pseudoLobby.textContent = profile.pseudo;
        statsLobby.innerHTML = `Niv: ${profile.niveau} | 💎 ${profile.gemes} | 💰 ${profile.pieces}`;

        avatarGame.src = avatarUrl;
        pseudoGame.textContent = profile.pseudo;
        statsGame.innerHTML = `Niv: ${profile.niveau} | 💎 ${profile.gemes} | 💰 ${profile.pieces}`;
      };

      // View switches
      const switchView = view =>
      {
        authSection.style.display = 'none';
        lobby.style.display = 'none';
        gameScreen.style.display = 'none';

        if (view === 'auth')
        {
          authSection.style.display = 'flex';
        }
        else if (view === 'lobby')
        {
          lobby.style.display = 'flex';
        }
        else if (view === 'game')
        {
          gameScreen.style.display = 'flex';
        }
      };

      // Auth event handlers
      loginForm.addEventListener('submit', e =>
      {
        e.preventDefault();
        clearMessages();

        const email = loginForm.loginEmail.value.trim().toLowerCase();
        const password = loginForm.loginPassword.value;

        if (!email)
        {
          document.getElementById('login-error').textContent = 'Veuillez saisir un e-mail.';
          return;
        }

        if (!password)
        {
          document.getElementById('login-error').textContent = 'Veuillez saisir un mot de passe.';
          return;
        }

        users = loadUsers();

        if (!(email in users))
        {
          document.getElementById('login-error').textContent = 'Utilisateur non trouvé.';
          return;
        }

        if (users[email].password !== hashPassword(password))
        {
          document.getElementById('login-error').textContent = 'Mot de passe incorrect.';
          return;
        }

        currentUser = email;
        sessionStorage.setItem('mspl_user', currentUser);
        loadProfile();
        switchView('lobby');
      });

      registerForm.addEventListener('submit', e =>
      {
        e.preventDefault();
        clearMessages();

        const email = registerForm.registerEmail.value.trim().toLowerCase();
        const password = registerForm.registerPassword.value;

        if (!email || !/\S+@\S+\.\S+/.test(email))
        {
          document.getElementById('register-error').textContent = 'Veuillez saisir un e-mail valide.';
          return;
        }

        if (!password || password.length < 6)
        {
          document.getElementById('register-error').textContent = 'Mot de passe trop court (min 6).';
          return;
        }

        users = loadUsers();

        if (email in users)
        {
          document.getElementById('register-error').textContent = 'Utilisateur déjà existant.';
          return;
        }

        users[email] =
        {
          password: hashPassword(password),
          profile:
          {
            pseudo: email.split('@')[0],
            niveau: 1,
            gemes: 35,
            pieces: 10000,
          },
        };

        saveUsers(users);

        currentUser = email;
        sessionStorage.setItem('mspl_user', currentUser);
        loadProfile();
        switchView('lobby');
      });

      // User logout
      logoutBtn.onclick = logoutGame;
      logoutGameBtn.onclick = logoutGame;

      function logoutGame()
      {
        currentUser = null;
        sessionStorage.removeItem('mspl_user');
        switchView('auth');
      }

      // Start game buttons
      modeCasual.onclick = () =>
      {
        startGame('casual');
      };

      modeTournament.onclick = () =>
      {
        startGame('tournament');
      };

      const maxHandCards = 14;

      // Start a new game session
      function startGame(mode)
      {
        deck = createDeck();
        shuffle(deck);

        const handCards = deck.splice(0,maxHandCards);

        renderHand(handCards);

        dropZones.forEach(zone => zone.innerHTML = '');

        updateXholButton();

        switchView('game');
      }

      // Creates two decks merged, with 2 jokers total
      function createDeck()
      {
        const suits = ['coeur', 'carreau', 'pique', 'trefle'];
        const ranks = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'V', 'D', 'R'];

        let deck = [];

        for (let pack = 0; pack < 2; pack++)
        {
          suits.forEach(suit =>
          {
            ranks.forEach(rank =>
            {
              deck.push({ suit, rank });
            });
          });
        }

        deck.push({ suit: 'Joker', rank: 'Joker' });
        deck.push({ suit: 'Joker', rank: 'Joker' });

        return deck;
      }

      // Shuffle utility
      function shuffle(array)
      {
        for (let i = array.length - 1; i > 0; i--)
        {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
      }

      // Renders hand cards
      function renderHand(cards)
      {
        playerHand.innerHTML = '';

        cards.forEach((card, idx) =>
        {
          playerHand.appendChild(createCardElement(card, idx));
        });

        setupDragAndDrop();
      }

      // Create card HTML element
      function createCardElement(card, id)
      {
        const div = document.createElement('div');

        div.className = 'card';

        if (card.suit === 'coeur' || card.suit === 'carreau')
        {
          div.classList.add('red');
        }

        div.id = `card-${id}`;
        div.draggable = true;

        if (card.rank === 'Joker')
        {
          div.style.backgroundColor = '#111';
          div.style.color = '#fde42a';
          div.style.fontSize = '2.8rem';
          div.style.textAlign = 'center';
          div.textContent = '🃏';
          div.style.lineHeight = '120px';
          div.style.userSelect = 'none';
        }
        else
        {
          const top = document.createElement('div');
          top.textContent = `${card.rank}${getSuitSymbol(card.suit)}`;
          top.style.fontSize = '1.5rem';
          top.style.lineHeight = '1.2em';

          const bottom = document.createElement('div');
          bottom.textContent = top.textContent;
          bottom.style.fontSize = '1.5rem';
          bottom.style.lineHeight = '1.2em';
          bottom.style.transform = 'rotate(180deg)';
          bottom.style.userSelect = 'none';

          div.style.backgroundColor = '#372e7a';
          div.style.border = div.classList.contains('red') ? '3px solid #f44a4a' : '3px solid #aaa';

          div.appendChild(top);
          div.appendChild(bottom);
        }

        setupDragEvents(div);

        return div;
      }

      function getSuitSymbol(suit)
      {
        switch (suit)
        {
          case 'coeur': return '♥';
          case 'carreau': return '♦';
          case 'pique': return '♠';
          case 'trefle': return '♣';
          default: return '';
        }
      }

      function setupDragEvents(card)
      {
        card.addEventListener('dragstart', e =>
        {
          draggedCard = e.target;
          draggedCard.classList.add('dragging');
          e.dataTransfer.effectAllowed = 'move';
        });

        card.addEventListener('dragend', e =>
        {
          draggedCard.classList.remove('dragging');
          draggedCard = null;
        });
      }

      dropZones.forEach(zone =>
      {
        zone.addEventListener('dragover', e =>
        {
          e.preventDefault();
          zone.classList.add('drag-over');
          e.dataTransfer.dropEffect = 'move';
        });

        zone.addEventListener('dragleave', e =>
        {
          zone.classList.remove('drag-over');
        });

        zone.addEventListener('drop', e =>
        {
          e.preventDefault();
          zone.classList.remove('drag-over');

          if (draggedCard)
          {
            zone.appendChild(draggedCard);

            updateXholButton();
          }
        });
      });

      playerHand.addEventListener('dragover', e =>
      {
        e.preventDefault();
        playerHand.classList.add('drag-over');
        e.dataTransfer.dropEffect = 'move';
      });

      playerHand.addEventListener('dragleave', e =>
      {
        playerHand.classList.remove('drag-over');
      });

      playerHand.addEventListener('drop', e =>
      {
        e.preventDefault();
        playerHand.classList.remove('drag-over');

        if (draggedCard)
        {
          playerHand.appendChild(draggedCard);

          updateXholButton();
        }
      });

      function updateXholButton()
      {
        if (playerHand.children.length === 0)
        {
          xholBtn.disabled = false;
          xholBtn.classList.add('enabled');
        }
        else
        {
          xholBtn.disabled = true;
          xholBtn.classList.remove('enabled');
        }
      }

      xholBtn.addEventListener('click', () =>
      {
        alert('Xhol déclenché. Implémentez ici la validation complète.');
      });

      document.getElementById('end-game').onclick = e =>
      {
        e.preventDefault();
        switchView('lobby');
        playerHand.innerHTML = '';
        dropZones.forEach(zone => zone.innerHTML = '');
        xholBtn.disabled = true;
        xholBtn.classList.remove('enabled');
      };

      init();

      function init()
      {
        users = loadUsers();

        const storedUser = sessionStorage.getItem('mspl_user');

        if (storedUser && (storedUser in users))
        {
          currentUser = storedUser;
          loadProfile();
          switchView('lobby');
        }
        else
        {
          switchView('auth');
        }
      }
    })();
  </script>
</body>
</html>
